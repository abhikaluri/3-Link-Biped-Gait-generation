A = [0, 0, 0, 1, 0, 0; 0, 0, 0, 0, 1, 0; 0, 0, 0, 0, 0, 1; -(2*(dq1*m*r*sin(q2) + dq2*m*r*sin(q2) + 2*Mt*dq1*l*sin(2*q1 + q3) + 2*Mt*dq3*l*sin(2*q1 + q3) - 2*dq1*m*r*cos(q2)*sin(q2) + 2*Mt*dq1*r*cos(2*q1 + q3)*sin(2*q1 + q3)))/(r*(4*Mh + 4*Mt + 4*m - 4*m*cos(q2)^2 - 4*Mt*cos(2*q1 + q3)^2 + m*r^2)), -(2*(dq1*m*sin(q2) + dq2*m*sin(q2)))/(4*Mh + 4*Mt + 4*m - 4*m*cos(q2)^2 - 4*Mt*cos(2*q1 + q3)^2 + m*r^2), -(4*Mt*(dq1*l*sin(2*q1 + q3) + dq3*l*sin(2*q1 + q3)))/(r*(4*Mh + 4*Mt + 4*m - 4*m*cos(q2)^2 - 4*Mt*cos(2*q1 + q3)^2 + m*r^2)), 0, 0, 0; (2*(4*Mh*dq1*r*sin(q2) + 4*Mt*dq1*r*sin(q2) + 5*dq1*m*r*sin(q2) + dq2*m*r*sin(q2) + 2*Mt*dq1*l*sin(2*q1 + q3) + 2*Mt*dq3*l*sin(2*q1 + q3) + dq1*m*r^3*sin(q2) - 4*dq1*m*r*cos(q2)*sin(q2) - 2*dq2*m*r*cos(q2)*sin(q2) - 4*Mt*dq1*l*sin(2*q1 + q3)*cos(q2) - 4*Mt*dq3*l*sin(2*q1 + q3)*cos(q2) + 2*Mt*dq1*r*cos(2*q1 + q3)*sin(2*q1 + q3) - 4*Mt*dq1*r*cos(2*q1 + q3)^2*sin(q2) - 4*Mt*dq1*r*cos(2*q1 + q3)*sin(2*q1 + q3)*cos(q2)))/(r*(4*Mh + 4*Mt + 4*m - 4*m*cos(q2)^2 - 4*Mt*cos(2*q1 + q3)^2 + m*r^2)), -(2*(dq1*m*sin(q2) + dq2*m*sin(q2))*(2*cos(q2) - 1))/(4*Mh + 4*Mt + 4*m - 4*m*cos(q2)^2 - 4*Mt*cos(2*q1 + q3)^2 + m*r^2), -(4*Mt*(2*cos(q2) - 1)*(dq1*l*sin(2*q1 + q3) + dq3*l*sin(2*q1 + q3)))/(r*(4*Mh + 4*Mt + 4*m - 4*m*cos(q2)^2 - 4*Mt*cos(2*q1 + q3)^2 + m*r^2)), 0, 0, 0; -(4*dq1*m*r^2*sin(2*q1 + q3) + dq1*m*r^4*sin(2*q1 + q3) - 4*Mt*dq1*l^2*sin(2*q1 + q3) - 4*Mt*dq3*l^2*sin(2*q1 + q3) + 4*Mh*dq1*r^2*sin(2*q1 + q3) + 4*Mt*dq1*r^2*sin(2*q1 + q3) - 4*dq1*m*r^2*sin(2*q1 + q3)*cos(q2)^2 + 2*dq1*m*r^2*cos(2*q1 + q3)*sin(q2) + 2*dq2*m*r^2*cos(2*q1 + q3)*sin(q2) - 2*dq1*l*m*r*sin(q2) - 2*dq2*l*m*r*sin(q2) + 4*Mt*dq3*l*r*cos(2*q1 + q3)*sin(2*q1 + q3) - 4*dq1*m*r^2*cos(2*q1 + q3)*cos(q2)*sin(q2) + 4*dq1*l*m*r*cos(q2)*sin(q2))/(l*(4*Mh*r + 4*Mt*r + 4*m*r + m*r^3 - 4*m*r*cos(q2)^2 - 4*Mt*r*cos(2*q1 + q3)^2)), (2*(dq1*l*m*sin(q2) + dq2*l*m*sin(q2) - dq1*m*r*cos(2*q1 + q3)*sin(q2) - dq2*m*r*cos(2*q1 + q3)*sin(q2)))/(l*(4*Mh + 4*Mt + 4*m - 4*m*cos(q2)^2 - 4*Mt*cos(2*q1 + q3)^2 + m*r^2)), (4*(Mt*dq1*l*sin(2*q1 + q3) + Mt*dq3*l*sin(2*q1 + q3) - Mt*dq1*r*cos(2*q1 + q3)*sin(2*q1 + q3) - Mt*dq3*r*cos(2*q1 + q3)*sin(2*q1 + q3)))/(4*Mh*r + 4*Mt*r + 4*m*r + m*r^3 - 4*m*r*cos(q2)^2 - 4*Mt*r*cos(2*q1 + q3)^2), 0, 0, 0];
B = [0, 0; 0, 0; 0, 0; (4*(2*cos(q2) - 1))/(r^2*(4*Mh + 4*Mt + 4*m - 4*m*cos(q2)^2 - 4*Mt*cos(2*q1 + q3)^2 + m*r^2)), -(44*(l - r*cos(2*q1 + q3)))/(l*r^2*(4*Mh + 4*Mt + 4*m - 4*m*cos(q2)^2 - 4*Mt*cos(2*q1 + q3)^2 + m*r^2)); (4*(4*Mh + 4*Mt + 5*m - 4*Mt*cos(2*q1 + q3)^2 + m*r^2 - 4*m*cos(q2)))/(m*r^2*(4*Mh + 4*Mt + 4*m - 4*m*cos(q2)^2 - 4*Mt*cos(2*q1 + q3)^2 + m*r^2)), -(44*(2*cos(q2) - 1)*(l - r*cos(2*q1 + q3)))/(l*(4*Mh*r^2 + 4*Mt*r^2 + 4*m*r^2 + m*r^4 - 4*m*r^2*cos(q2)^2 - 4*Mt*r^2*cos(2*q1 + q3)^2)); (4*(l - 2*l*cos(q2) - r*cos(2*q1 + q3) + 2*r*cos(2*q1 + q3)*cos(q2)))/(l*(4*Mh*r^2 + 4*Mt*r^2 + 4*m*r^2 + m*r^4 - 4*m*r^2*cos(q2)^2 - 4*Mt*r^2*cos(2*q1 + q3)^2)), (11*(4*Mt*l^2 + 4*Mh*r^2 + 4*Mt*r^2 + 4*m*r^2 + m*r^4 - 4*m*r^2*cos(q2)^2 - 8*Mt*l*r*cos(2*q1 + q3)))/(Mt*l^2*(4*Mh*r^2 + 4*Mt*r^2 + 4*m*r^2 + m*r^4 - 4*m*r^2*cos(q2)^2 - 4*Mt*r^2*cos(2*q1 + q3)^2))];
